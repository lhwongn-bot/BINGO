<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="zh-HK">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>國慶日 Bingo 抽獎遊戲</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <style>
    @font-face {
      font-family: 'BiauKai';
      src: url('https://fonts.cdnfonts.com/css/biaukai');
    }
    body {
      font-family: 'BiauKai', sans-serif;
      background: linear-gradient(135deg, #ff0000, #ff6666, #ff9999);
      color: #fff;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      overflow: hidden;
    }
    #drawn-word {
      font-size: 4rem;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
      transition: opacity 0.5s ease-in-out;
    }
    #draw-button {
      background: linear-gradient(45deg, #ffd700, #ffa500);
      color: #8b0000;
      font-size: 1.5rem;
      padding: 1rem 2rem;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      transition: transform 0.2s;
    }
    #draw-button:hover {
      transform: scale(1.05);
    }
    #history {
      background: rgba(255, 255, 255, 0.2);
      border-radius: 10px;
      padding: 1rem;
      max-height: 150px;
      overflow-y: auto;
      width: 320px;
    }
    .word-animate {
      animation: wordReveal 6s ease-in-out forwards;
    }
    @keyframes wordReveal {
      0% {
        opacity: 0;
        transform: scale(0.5) rotate(0deg);
        text-shadow: 0 0 0 rgba(255, 215, 0, 0);
      }
      50% {
        opacity: 1;
        transform: scale(1.2) rotate(1080deg);
        text-shadow: 0 0 20px rgba(255, 215, 0, 0.8);
      }
      100% {
        opacity: 1;
        transform: scale(1) rotate(1080deg);
        text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
      }
    }
  </style>
</head>
<body>
  <div class="text-center p-6">
    <h1 class="text-5xl mb-6 text-yellow-300">國慶日 Bingo 抽獎</h1>
    <div id="drawn-word" class="mb-8">點擊抽獎</div>
    <button id="draw-button" onclick="drawWord()">抽獎</button>
    <div id="history" class="absolute bottom-4 left-4 text-left text-lg">
      <h2 class="text-xl font-bold mb-2">抽獎紀錄</h2>
      <div id="history-list"></div>
    </div>
  </div>

  <script>
    const words = [
      "國慶日", "慶典", "普天同慶", "喜慶", "慶祝活動", "彩旗", "掛飾", "紅色主題", "煙花", "花車巡遊",
      "天安門", "北京", "香港", "中華人民共和國", "國旗", "國徽", "升旗儀式", "長城", "鳳凰", "龍",
      "國歌", "我的祖國", "東方之珠", "獅子山下", "合唱", "表演", "舞蹈", "才藝", "樂器", "鼓掌",
      "回歸", "主權", "建國", "1949年", "一國兩制", "五星紅旗", "國慶假期", "國慶七天樂", "國慶黃金周", "中央政府",
      "禮物", "禮品包", "紅包", "國慶賀卡", "手工藝", "貼紙", "摺紙", "DIY", "國旗貼紙", "紀念品",
      "Bingo", "掉彩虹", "問答遊戲", "懷舊金曲", "傾計時段", "義工協助", "人釘人服務", "安慰獎", "活動紙", "長者合照",
      "愛國", "團結", "和諧", "共融", "家國情懷", "繁榮昌盛", "國泰民安", "身體健康", "心想事成", "萬事如意",
      "國慶由來", "建國歷史", "中國地圖", "中國文化", "中華民族", "民族團結", "國家象徵", "國慶故事", "國慶知識", "國慶問答",
      "主題背景", "活動海報", "主題口號", "活動流程", "活動主持", "活動場地佈置", "活動紀錄", "活動相簿", "活動回顧", "活動評估",
      "國慶拼圖", "國慶畫作", "國慶故事分享", "國慶影片", "國慶相框", "國慶小冊子", "國慶主題曲", "國慶小遊戲", "國慶祝福牆", "國慶心意卡"
    ];
    let availableWords = [...words];
    let history = [];

    // Load sound effects
    const buttonSound = new Audio('https://freesound.org/data/previews/577/577800_6494682-lq.mp3'); // Party popper sound
    const spinSound = new Audio('https://freesound.org/data/previews/145/145443_2433154-lq.mp3'); // Spin sound

    // Preload sounds to minimize delay
    buttonSound.preload = 'auto';
    spinSound.preload = 'auto';

    function drawWord() {
      if (availableWords.length === 0) {
        document.getElementById('drawn-word').innerText = '所有詞語已抽完！';
        return;
      }

      // Play party popper sound for button press
      buttonSound.play().catch(error => console.log('Button sound error:', error));

      const drawButton = document.getElementById('draw-button');
      drawButton.disabled = true;
      const drawnWordElement = document.getElementById('drawn-word');
      drawnWordElement.style.opacity = 0;

      // Trigger confetti burst
      confetti({
        particleCount: 100,
        spread: 70,
        origin: { y: 0.6 },
        colors: ['#ff0000', '#ffd700', '#ffffff'],
        shapes: ['circle', 'square'],
        scalar: 1.2,
        disableForReducedMotion: true
      });

      setTimeout(() => {
        const randomIndex = Math.floor(Math.random() * availableWords.length);
        const selectedWord = availableWords[randomIndex];
        availableWords.splice(randomIndex, 1);

        // Play spin sound
        spinSound.play().catch(error => console.log('Spin sound error:', error));

        drawnWordElement.innerText = selectedWord;
        drawnWordElement.classList.add('word-animate');
        drawnWordElement.style.opacity = 1;

        // Log to history after animation ends
        setTimeout(() => {
          history.push(selectedWord);
          updateHistory();
          drawnWordElement.classList.remove('word-animate');
          drawButton.disabled = false;
        }, 6000);
      }, 500);
    }

    function updateHistory() {
      const historyList = document.getElementById('history-list');
      historyList.innerHTML = '';
      for (let i = 0; i < history.length; i += 4) {
        const row = document.createElement('div');
        row.innerText = `${history[i] || ''} ${history[i + 1] || ''} ${history[i + 2] || ''} ${history[i + 3] || ''}`.trim();
        historyList.appendChild(row);
      }
    }
  </script>
</body>
</html>